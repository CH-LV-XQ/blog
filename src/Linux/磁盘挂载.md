---
icon: pen-to-square
date: 2025-09-16
category:
  - Linux
---

# Linux 磁盘挂载操作

> **一、识别磁盘**

首先确定要挂载的磁盘名称（新磁盘通常为 /dev/sd* 格式）：
```shell
# 查看所有磁盘及分区信息
lsblk

# 查看详细的磁盘信息（含容量、类型）
sudo fdisk -l
```
* 输出说明： 
  * 系统盘通常是 /dev/sda（包含 /dev/sda1、/dev/sda2 等分区） 
  * 新磁盘可能显示为 /dev/sdb、/dev/sdc 等（无分区信息）
> **二、磁盘分区（新磁盘必须执行）**

如果磁盘未分区，需要先创建分区（以 /dev/sdb 为例）：

1、进入分区工具
```shell
sudo fdisk /dev/sdb
```
2、输入命令进行分区： 
* 输入 n → 选择 p（主分区）→ 分区号默认 1 → 起始扇区默认（回车）→ 结束扇区默认（使用全部空间，或输入 +50G 指定大小） 
* 输入 w 保存分区设置，退出工具

3、验证分区是否创建成功：
```shell
lsblk /dev/sdb
```
此时会显示新分区 /dev/sdb1。

> **三、格式化分区（创建文件系统）**

分区后需要格式化（选择文件系统类型，常用 ext4 或 xfs）：
```shell
# 格式化为 ext4（兼容性好，推荐）
sudo mkfs.ext4 /dev/sdb1

# 格式化为 xfs（适合大文件，性能优）
sudo mkfs.xfs /dev/sdb1
```
* 注意：格式化会清空数据，确认磁盘无重要文件再执行！

> **四、创建挂载点**

挂载点是访问磁盘的目录（需为空目录）：
```shell
# 创建挂载点目录（例如 /data）
sudo mkdir -p /data
```

> **五、永久挂载（重启后自动生效）**

通过 /etc/fstab 配置实现永久挂载（推荐用 UUID 避免设备名变动）：
1、获取分区的 UUID：
```shell
sudo blkid /dev/sdb1
```
输出示例：/dev/sdb1: UUID="5879efd5-b4fb-40e1-9cb1-8629abe0beb0" BLOCK_SIZE="4096" TYPE="ext4" PARTUUID="117c400c-01"

2、编辑 /etc/fstab 文件：
```shell
sudo vim /etc/fstab
```
3、在文件末尾添加以下内容（按实际 UUID 和文件系统修改）：
```text
# 格式：UUID=磁盘UUID  挂载点  文件系统类型  挂载参数  备份标记  检查顺序
UUID=5879efd5-b4fb-40e1-9cb1-8629abe0beb0  /data  ext4  defaults  0  0
```
* defaults：默认参数（可读可写、自动挂载） 
* 最后两个 0：表示不备份、不检查（系统分区通常为 0 1）

4、验证配置是否正确（避免错误导致系统无法启动）：
```shell
sudo mount -a
```
* 无报错说明配置正确，重启后会自动挂载。

> **六、卸载磁盘**

如需移除磁盘，先卸载：
```shell
# 卸载已挂载的分区
sudo umount /data

# 若提示"设备忙"，先终止占用进程
sudo fuser -k /data  # 强制终止使用 /data 的进程
sudo umount /data
```
> **七、卸载后再次挂载**

1、确认磁盘 / 分区信息
```shell
# 查看所有磁盘及分区
lsblk

# 或查看分区的UUID（如果之前用UUID配置过）
sudo blkid
```
* 会看到之前创建的分区（如 /dev/sdb1），以及它的 UUID。

2、永久挂载（之前已配置 /etc/fstab）
* 自动挂载（推荐）：
  * 直接执行以下命令，系统会根据 /etc/fstab 中的配置自动挂载所有未挂载的分区：
    ```shell
    sudo mount -a
    ```
* 手动指定挂载点：
  * 也可以直接挂载到 /etc/fstab 中配置的目录（如 /data）：
  ```shell
    sudo mount /data
    ```
  系统会自动匹配 /etc/fstab 中 /data 对应的分区。

3、注意
* 挂载点目录：必须是之前使用的目录（如 /data），否则可能找不到之前的数据（数据实际存储在分区中，挂载点只是访问入口）。 
* 权限问题：如果挂载后无法访问文件，可能是权限问题，可重新设置挂载点权限：
  ```shell
    sudo chmod -R 755 /data  # 根据实际需求调整权限
  ```
* 设备名变动：如果磁盘设备名变了（如 /dev/sdb1 变成 /dev/sdc1，可能发生在插拔其他磁盘后），用 UUID 挂载更可靠，因为 UUID 是分区的唯一标识，不会随设备名变动。


> **八、常见问题解决**

1、挂载时提示 "wrong fs type"：
* 原因：文件系统类型不匹配（如格式化为 xfs 却写了 ext4） 
* 解决：检查 mkfs 命令和 /etc/fstab 中的文件系统类型是否一致

2、重启后挂载点为空：
* 原因：/etc/fstab 配置错误或 UUID 不正确 
* 解决：重新核对 UUID 和配置格式，执行 sudo mount -a 排查错误

3、无法写入文件：
* 原因：权限不足 
* 解决：修改挂载点权限：sudo chmod 777 /data（根据需求调整权限）
